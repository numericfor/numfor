<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NuMFor: qag Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="highlight.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NuMFor
   &#160;<span id="projectnumber">b329b49 (2019-12-19)</span>
   </div>
   <div id="projectbrief">Numerical (Modern) Fortran. Library for Simple Numerical computing</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00574.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="a00571.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">qag Interface Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Globally adaptive integration routine without weights.  
 <a href="a00574.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Globally adaptive integration routine without weights. </p>
<p>The routine calculates an approximation <img class="formulaInl" alt="$J$" src="form_21.png"/> to a definite integral </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ J \approx I =\int_{a}^{b} f(x, args) dx \]" src="form_22.png"/>
</p>
<p> hopefully satisfying </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ || I - J || \le \max ( epsabs, epsrel \cdot ||I|| ). \]" src="form_23.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>The function to integrate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>(real) lower limit of integration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>(real) upper limit of integration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>(real, array, <b>optional</b>) extra arguments (if needed) to be passed to the function <code>f</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">IntVal</td><td>(same kind as <code>f</code>) Approximation to integral </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epsabs</td><td>(real, <b>optional</b>) Absolute accuracy requested. Default = 1.e-7 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epsrel</td><td>(real, <b>optional</b>) Relative accuracy requested. Default = 1.e-5 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rule</td><td>(character, <b>optional</b>) Choice of integration rule. Default = 'qk21'. Options are:<ul>
<li>"qk15" -&gt; 7 Gauss points, 15 Gauss-Kronrod points,</li>
<li>"qk21" -&gt; 10 Gauss points, 21 Gauss-Kronrod points,</li>
<li>"qk31" -&gt; 15 Gauss points, 31 Gauss-Kronrod points,</li>
<li>"qk41" -&gt; 20 Gauss points, 41 Gauss-Kronrod points,</li>
<li>"qk51" -&gt; 25 Gauss points, 51 Gauss-Kronrod points,</li>
<li>"qk61" -&gt; 30 Gauss points, 61 Gauss-Kronrod points. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">abserr</td><td>(real, <b>optional</b>) Estimation of absolute error achieved </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">neval</td><td>(integer, <b>optional</b>) Number of function evaluations performed </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>(integer, <b>optional</b>) Error code </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">info</td><td>(<b>optional</b>) Information and workspace. Must be of type <a class="el" href="a00658.html">d_qp_extra</a> for integration of real functions and of type <a class="el" href="a00662.html">c_qp_extra</a> for integration of complex functions.</td></tr>
  </table>
  </dd>
</dl>
<p>This is a simple globally adaptive integrator using the strategy of Aind (Piessens, 1973). The QAG algorithm is a simple adaptive integration procedure. The integration region is divided into subintervals, and on each iteration the subinterval with the largest estimated error is bisected. This reduces the overall error rapidly, as the subintervals become concentrated around local difficulties in the integrand. It is possible to choose between 6 pairs of Gauss-Kronrod quadrature formulae for the rule evaluation component. The pairs of high degree of precision are suitable for handling integration difficulties due to a strongly oscillating integrand.</p>
<dl class="section note"><dt>Note</dt><dd>If present, <code>info</code> will store and use information about subdivisions, limits, errors, and status messages.</dd></dl>
<h2>Example: </h2>
<div class="fragment"><div class="line"><span class="keywordtype">  real</span>(dp) :: Integ1</div><div class="line">  <span class="keywordtype">complex(dp)</span> :: Integ2</div><div class="line"><span class="keywordtype">  real</span>(dp), <span class="keywordtype">parameter</span> :: epsrel = 1.e-3_8</div><div class="line"></div><div class="line">  <span class="keywordtype">intrinsic</span> dsin</div><div class="line">  print <span class="stringliteral">&quot;(A)&quot;</span>, center(<span class="stringliteral">&quot; Integrate sin(x) between 0 and pi &quot;</span>, 70, <span class="stringliteral">&#39;-&#39;</span>)</div><div class="line">  <span class="keyword">call </span>qag(dsin, zero, m_pi, integ1)</div><div class="line">  print <span class="stringliteral">&quot;(A)&quot;</span>, <span class="stringliteral">&#39;\int \sin(x) dx = &#39;</span>//str(integ1)//<span class="stringliteral">&quot; (Difference=&quot;</span>//str(abs(2 - integ1))//<span class="stringliteral">&quot;)&quot;</span></div><div class="line">  <span class="comment">! that prints:</span></div><div class="line">  <span class="comment">!------------------ Integrate sin(x) between 0 and pi -----------------</span></div><div class="line">  <span class="comment">! \int \sin(x) dx = 2 (Difference=0)</span></div></div><!-- fragment --></div><hr/>The documentation for this interface was generated from the following file:<ul>
<li><a class="el" href="a00158.html">wquadpack.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="a00466.html">quadpack</a></li><li class="navelem"><a class="el" href="a00574.html">qag</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
